!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).maquette={})}(this,function(e){"use strict";function l(t,r){var o={};return Object.keys(t).forEach(function(e){o[e]=t[e]}),r&&Object.keys(r).forEach(function(e){o[e]=r[e]}),o}function h(e,t){return e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties)}function A(e){if("string"!=typeof e)throw Error("Style values must be strings")}function m(e,t,r,o){var n=e[t];if(""!==n.vnodeSelector){var i=n.properties;if(!(i&&(void 0===i.key?i.bind:i.key)))for(var d=0;d<e.length;d++)if(d!==t&&h(e[d],n))throw{error:Error("".concat(r.vnodeSelector," had a ").concat(n.vnodeSelector," child ").concat("added"===o?o:"removed",", but there is now more than one. You must add unique key properties to make them distinguishable.")),parentNode:r,childNode:n}}}function t(){p=!1,a.forEach(s),a.length=0}function o(e){a.push(e),p||(p=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(t,{timeout:16}):setTimeout(t,16))}function g(e){var t=e.domNode;if(e.properties){var r=e.properties.exitAnimation;if(r)return t.style.pointerEvents="none",r(t,function(){t.parentNode&&(t.parentNode.removeChild(t),o(e))},e.properties),0}t.parentNode&&(t.parentNode.removeChild(t),o(e))}function n(f,u,v){if(u)for(var h=v.eventHandlerInterceptor,m=Object.keys(u),e=m.length,g=0;g<e;g++)!function(e){var t,r=m[g],o=u[r];if("className"===r)throw Error('Property "className" is not supported, use "class".');if("class"===r)k(f,o,!0);else if("classes"===r)for(var n=Object.keys(o),i=n.length,d=0;d<i;d++){var a=n[d];o[a]&&f.classList.add(a)}else if("styles"===r)for(var p=Object.keys(o),s=p.length,d=0;d<s;d++){var c=p[d],l=o[c];l&&(A(l),v.styleApplyer(f,c,l))}else"key"!==r&&null!=o&&("function"==(e=typeof o)?(r.lastIndexOf("on",0)||(h&&(o=h(r,o,f,u)),"oninput"===r&&(t=o,o=function(e){t.call(this,e),e.target["oninput-value"]=e.target.value})),f[r]=o):v.namespace===S?"href"===r?f.setAttributeNS(w,r,o):f.setAttribute(r,o):"string"==e&&"value"!==r&&"innerHTML"!==r?f.setAttribute(r,o):f[r]=o)}()}function f(e,t,r){!function(e,t,r){if(t)for(var o=0,n=t;o<n.length;o++){var i=n[o];N(i,e,void 0,r)}}(e,t.children,r),t.text&&(e.textContent=t.text),n(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.call(t.properties.bind||t.properties,e,r,t.vnodeSelector,t.properties,t.children)}function i(t,r){return{getLastRender:function(){return t},update:function(e){if(t.vnodeSelector!==e.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");b(t,t=e,r)},domNode:t.domNode}}function d(e){return l(c,e)}var r="http://www.w3.org/",S="".concat(r,"2000/svg"),w="".concat(r,"1999/xlink"),y=[],a=[],p=!1,s=function(e){(e.children||[]).forEach(s),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.call(e.properties.bind||e.properties,e.domNode)},N=function(e,t,r,o){var n,i=0,d=e.vnodeSelector,a=t.ownerDocument;if(""===d)n=e.domNode=a.createTextNode(e.text),void 0!==r?t.insertBefore(n,r):t.appendChild(n);else{for(var p=0;p<=d.length;++p){var s,c=d[0|p]||"";p!==d.length&&"."!=c&&"#"!=c||(s=d[0|i-1]||"",c=d.slice(i,p),"."==s?n.classList.add(c):"#"==s?n.id=c:(void 0!==(o="svg"===c?l(o,{namespace:S}):o).namespace?n=e.domNode=a.createElementNS(o.namespace,c):(n=e.domNode=e.domNode||a.createElement(c),"input"===c&&e.properties&&void 0!==e.properties.type&&n.setAttribute("type",e.properties.type)),void 0!==r?t.insertBefore(n,r):n.parentNode!==t&&t.appendChild(n)),i=p+1)}f(n,e,o)}},k=function(t,e,r){e&&e.split(" ").forEach(function(e){e&&t.classList.toggle(e,r)})},b=function(e,t,r){var o=e.domNode;if(e===t)return!1;var n=!1;if(""===t.vnodeSelector){if(t.text!==e.text){var i=o.ownerDocument.createTextNode(t.text);return o.parentNode.replaceChild(i,o),t.domNode=i,!0}t.domNode=o}else t.vnodeSelector.lastIndexOf("svg",0)||(r=l(r,{namespace:S})),e.text!==t.text&&(n=!0,void 0===t.text?o.removeChild(o.firstChild):o.textContent=t.text),t.domNode=o,n=function(e,t,r,o,n){if(r===o)return!1;for(var i,d,a=(r=r||y).length,p=(o=o||y).length,s=0,c=0,l=!1;c<p;){var f=s<a?r[s]:void 0,u=o[c];if(void 0!==f&&h(f,u))l=b(f,u,n)||l,s++;else{var v=function(e,t){if(""!==t.vnodeSelector)for(var r=s+1;r<e.length;r++)if(h(e[r],t))return r;return-1}(r,u);if(v<0)N(u,t,s<a?r[s].domNode:void 0,n),d=void 0,!(f=u).properties||(d=f.properties.enterAnimation)&&d(f.domNode,f.properties),m(o,c,e,"added");else{for(i=s;i<v;i++)g(r[i]),m(r,i,e,"removed");l=b(r[v],u,n)||l,s=v+1}}c++}if(s<a)for(i=s;i<a;i++)g(r[i]),m(r,i,e,"removed");return l}(t,o,e.children,t.children,r)||n,n=function(e,t,r,o){if(r){for(var n=!1,i=Object.keys(r),d=i.length,a=0;a<d;a++){var p,s=i[a],c=r[s],l=t[s];if("class"===s)l!==c&&(k(e,l,!1),k(e,c,!0));else if("classes"===s)for(var f=e.classList,u=Object.keys(c),v=u.length,h=0;h<v;h++){var m=u[h],g=!!c[m];g!=!!l[m]&&(n=!0,g?f.add(m):f.remove(m))}else if("styles"===s)for(var y=Object.keys(c),N=y.length,h=0;h<N;h++){var b=y[h],x=c[b];x!==l[b]&&(n=!0,x?(A(x),o.styleApplyer(e,b,x)):o.styleApplyer(e,b,""))}else c||"string"!=typeof l||(c=""),"value"===s?((p=e[s])!==c&&(e["oninput-value"]?p===e["oninput-value"]:c!==l)&&(e[s]=c,e["oninput-value"]=void 0),c!==l&&(n=!0)):c!==l&&("function"==(p=typeof c)&&o.eventHandlerInterceptor||(o.namespace===S?"href"===s?e.setAttributeNS(w,s,c):e.setAttribute(s,c):"string"==p&&"innerHTML"!==s?"role"===s&&""===c?e.removeAttribute(s):e.setAttribute(s,c):e[s]!==c&&(e[s]=c),n=!0))}return n}}(o,e.properties,t.properties,r)||n,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.call(t.properties.bind||t.properties,o,r,t.vnodeSelector,t.properties,t.children);return n&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(o,t.properties,e.properties),!1},c={namespace:void 0,performanceLogger:function(){},eventHandlerInterceptor:void 0,styleApplyer:function(e,t,r){"-"==(t[0]||"")?e.style.setProperty(t,r):e.style[t]=r}},u={create:function(e,t){return t=d(t),N(e,document.createElement("div"),void 0,t),i(e,t)},append:function(e,t,r){return r=d(r),N(t,e,void 0,r),i(t,r)},insertBefore:function(e,t,r){return r=d(r),N(t,e.parentNode,e,r),i(t,r)},merge:function(e,t,r){return r=d(r),f(t.domNode=e,t,r),i(t,r)},replace:function(e,t,r){return r=d(r),N(t,e.parentNode,e,r),e.parentNode.removeChild(e),i(t,r)}},v=function(e,t,r){for(var o=0,n=t.length;o<n;o++){var i=t[o];Array.isArray(i)?v(e,i,r):null!=i&&!1!==i&&("string"==typeof i&&(i={vnodeSelector:"",properties:void 0,children:void 0,text:i.toString(),domNode:null}),r.push(i))}},x=Array.prototype.find?function(e,t){return e.find(t)}:function(e,t){return e.filter(t)[0]};e.createCache=function(){var o,n;return{invalidate:function(){o=n=void 0},result:function(e,t){if(o)for(var r=0;r<e.length;r++)o[r]!==e[r]&&(n=void 0);return n||(n=t(),o=e),n}}},e.createMapping=function(c,l,f){var u=[],v=[];return{results:v,map:function(e){for(var t=e.map(c),r=v.slice(),o=0,n=0;n<e.length;n++){var i=e[n],d=t[n];if(d===u[o])v[n]=r[o],f(i,r[o],n),o++;else{for(var a=!1,p=1;p<u.length+1;p++){var s=(o+p)%u.length;if(u[s]===d){v[n]=r[s],f(e[n],r[s],n),o=1+s,a=!0;break}}a||(v[n]=l(i,n))}}v.length=e.length,u=t}}},e.createProjector=function(e){function r(e,t,r){var i,d,a;function n(e){a("domEvent",e);var t=i;(n=function(e,t){for(var r=[];e&&e!==t;)r.push(e),e=e.parentNode;return r}(e.currentTarget,t.domNode)).reverse();var r,o,n=(t=t.getLastRender(),r=t,n.forEach(function(t){r=r&&r.children?x(r.children,function(e){return e.domNode===t}):void 0}),r);return d.scheduleRender(),n&&(o=n.properties["on".concat(e.type)].apply(n.properties.bind||this,arguments)),a("domEventProcessed",e),o}p.eventHandlerInterceptor=(d=f,a=s,function(e,t,r,o){return n}),i=e(t,r(),p),c.push(i),l.push(r)}function t(){if(o=void 0,n){n=!1,s("renderStart",void 0);for(var e=0;e<c.length;e++){var t=l[e]();s("rendered",void 0),c[e].update(t),s("patched",void 0)}s("renderDone",void 0),n=!0}}var o,p=d(e),s=p.performanceLogger,n=!0,i=!1,c=[],l=[],f={renderNow:t,scheduleRender:function(){o||i||(o=requestAnimationFrame(t))},stop:function(){o&&(cancelAnimationFrame(o),o=void 0),i=!0},resume:function(){n=!(i=!1),f.scheduleRender()},append:function(e,t){r(u.append,e,t)},insertBefore:function(e,t){r(u.insertBefore,e,t)},merge:function(e,t){r(u.merge,e,t)},replace:function(e,t){r(u.replace,e,t)},detach:function(e){for(var t=0;t<l.length;t++)if(l[t]===e)return l.splice(t,1),c.splice(t,1)[0];throw Error("renderFunction was not found")}};return f},e.dom=u,e.h=function(e,t,r){if(Array.isArray(t))r=t,t=void 0;else if(t&&("string"==typeof t||t.vnodeSelector)||r&&("string"==typeof r||r.vnodeSelector))throw Error("h called with invalid arguments");var o,n;return r&&1===r.length&&"string"==typeof r[0]?o=r[0]:r&&(v(e,r,n=[]),0===n.length&&(n=void 0)),{vnodeSelector:e,properties:t,children:n,text:""===o?void 0:o,domNode:null}},Object.defineProperty(e,"__esModule",{value:!0})});