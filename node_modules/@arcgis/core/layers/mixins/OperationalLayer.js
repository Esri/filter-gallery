/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import r from"../../core/Error.js";import{isBlobProtocol as t}from"../../core/urlUtils.js";import{property as i}from"../../core/accessorSupport/decorators/property.js";import"../../core/arrayUtils.js";import"../../core/has.js";import"../../core/accessorSupport/ensureType.js";import{subclass as o}from"../../core/accessorSupport/decorators/subclass.js";import{writer as s}from"../../core/accessorSupport/decorators/writer.js";import{readLoadable as a}from"../../core/accessorSupport/read.js";import{willPropertyWrite as n}from"../../core/accessorSupport/write.js";import{supportedTypes as p}from"./operationalLayers.js";import{opacity as l}from"../support/commonProperties.js";const y=y=>{let u=class extends y{constructor(){super(...arguments),this.title=null}writeListMode(e,r,t,i){(i&&"ground"===i.layerContainerType||e&&n(this,t,{},i))&&(r[t]=e)}writeOperationalLayerType(e,r,t,i){!e||i&&"tables"===i.layerContainerType||(r.layerType=e)}writeTitle(e,r){r.title=e||"Layer"}read(e,r){r&&(r.layer=this),a(this,e,(r=>super.read(e,r)),r)}write(e,i){if(null!=i&&i.origin){const e=`${i.origin}/${i.layerContainerType||"operational-layers"}`,t=p[e];let s=t&&t[this.operationalLayerType];var o;if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(s=!1),!s)return null==(o=i.messages)||o.push(new r("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const s=super.write(e,{...i,layer:this}),a=!!i&&!!i.messages&&!!i.messages.filter((e=>e instanceof r&&"web-document-write:property-required"===e.name)).length;var n;return t(null==s?void 0:s.url)?(null==i||null==(n=i.messages)||n.push(new r("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&a?null:s}beforeSave(){}};return e([i({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],u.prototype,"id",void 0),e([i({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],u.prototype,"listMode",void 0),e([s("listMode")],u.prototype,"writeListMode",null),e([i({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],u.prototype,"operationalLayerType",void 0),e([s("operationalLayerType")],u.prototype,"writeOperationalLayerType",null),e([i(l)],u.prototype,"opacity",void 0),e([i({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],u.prototype,"title",void 0),e([s("title")],u.prototype,"writeTitle",null),e([i({type:Boolean,json:{name:"visibility"}})],u.prototype,"visible",void 0),u=e([o("esri.layers.mixins.OperationalLayer")],u),u};function u(e){return"operationalLayerType"in e}export{y as OperationalLayer,u as isOperationalLayer};
