/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{isSome as e}from"../../core/maybe.js";import{getJsonType as r}from"../../geometry/support/jsonUtils.js";import{toDynamicLayersJSON as t}from"../utils.js";const n=e=>e.spatialReference.wkid||JSON.stringify(e.spatialReference);function i(i,a){const{dpi:o,gdbVersion:s,geometry:m,geometryPrecision:l,height:y,layerOption:f,mapExtent:p,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,spatialReference:O,timeExtent:$,tolerance:N,width:j}=i.toJSON(),{dynamicLayers:R,layerDefs:b,layerIds:w}=t(i),J=a&&e(a.geometry)?a.geometry:null,S={geometryPrecision:l,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,tolerance:N},V=J&&J.toJSON()||m;if(S.imageDisplay=`${j},${y},${o}`,s&&(S.gdbVersion=s),V&&(delete V.spatialReference,S.geometry=JSON.stringify(V),S.geometryType=r(V)),O?S.sr=O.wkid||JSON.stringify(O):V&&V.spatialReference?S.sr=n(V):p&&p.spatialReference&&(S.sr=n(p)),S.time=$?[$.start,$.end].join(","):null,p){const{xmin:e,ymin:r,xmax:t,ymax:n}=p;S.mapExtent=`${e},${r},${t},${n}`}return b&&(S.layerDefs=b),R&&!b&&(S.dynamicLayers=R),S.layers=f,w&&!R&&(S.layers+=`:${w.join(",")}`),S}export{i as identifyToIdentifyRESTParameters};
