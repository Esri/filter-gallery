/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import e from"../../../core/Error.js";import{isSome as r}from"../../../core/maybe.js";import{createUVRenderer as t,isSingleBand8BitRasterWithStats as a,getClassField as o}from"../../../renderers/support/rasterRendererHelper.js";import{processRasterRendererParameters as s}from"../support/utils.js";async function n(r){var t;r=await s(r);const{rasterInfo:n}=r.layer;if(n.bandCount>1)throw new e("raster-class-breaks-renderer:not-supported","Multiband raster is not supported");if(null===n.attributeTable&&!a(n))throw new e("raster-unique-value-renderer:not-supported","The source raster does not have an attribute table");const i=null==(t=r.classFieldName)?void 0:t.toLowerCase();if(i&&!n.attributeTable.fields.some((e=>e.name.toLowerCase()===i)))throw new e("raster-unique-value-renderer:invalid-parameters","A valid 'classfieldName' is required");return i||(r.classFieldName=o(n.attributeTable).name),r}async function i(a){a=await n(a);const{classFieldName:o,colors:s,colorRamp:i}=a,u=t(a.layer.rasterInfo,o,s,i);if(!r(u))throw new e("raster-unique-value-renderer:not-supported","UniqueValueRenderer is not supported on the provided data source");return{renderer:u,classFieldName:o}}export{i as createRenderer};
