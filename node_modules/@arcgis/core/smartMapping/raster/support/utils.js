/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import r from"../../../core/Error.js";import{getSupportedRendererTypes as e,createDefaultRenderer as a,getDefaultBandCombination as t}from"../../../renderers/support/rasterRendererHelper.js";import s from"./adapters/ImageryLayerAdapter.js";import n from"./adapters/ImageryTileLayerAdapter.js";const l={imagery:{adapter:s,label:"ImageryLayer"},"imagery-tile":{adapter:n,label:"ImageryTileLayer"},wcs:{adapter:n,label:"WCSLayer"}},o={"raster-stretch":"raster-stretch","unique-value":"raster-unique-value","raster-rgb":"raster-rgb","class-breaks":"raster-class-breaks","raster-colormap":"raster-colormap","raster-shaded-relief":"raster-shaded-relief","vector-field":"raster-vector-field",flow:"raster-flow"},i=Object.keys(l).map((r=>l[r].label));function d(r){var e;if("raster-layer-adapter"===r.type)return r;const a=null==(e=l[r.type])?void 0:e.adapter;return null==a?null:new a({layer:r})}async function p(r){var t;const s=d((r=await c(r)).layer),n=await s.generateRasterInfo(r),l=e(n).map((r=>o[r])),i=a(n),{bandCount:p}=n;return p>1&&l.push("raster-rgb"),l.indexOf("raster-class-breaks")<0&&1===p&&(null==(t=s.layer)?void 0:t.version)>=10.3&&l.push("raster-class-breaks"),{supportedTypes:l,defaultRenderer:i}}async function u(r){const e=d((r=await c(r)).layer),a=await e.generateRasterInfo(r);return t(a)}async function c(e){const{layer:a}=e;if(!a)throw new r("raster-renderer-creator:missing-parameters","'layer' parameter is required");const t=d(a);if(null==t)throw new r("raster-renderer-creator:invalid-parameters","'layer' must be one of these types: "+i.join(", "));return await t.load(),await t.updateRasterInfo({renderingRule:e.renderingRule,signal:e.signal}),{...e,layer:t}}export{d as createRasterLayerAdapter,u as getDefaultBandCombination,p as getSupportedRendererInfo,c as processRasterRendererParameters};
