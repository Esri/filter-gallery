/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import e from"../../../layers/support/RangeDomain.js";import i from"../FieldConfig.js";import n from"../FieldGroupConfig.js";function t(e){var i;const n={},t=[];return null==(i=e.expressionInfos)||i.map((e=>n[e.name]=e.expression)),{config:l(e.elements,n,t),encounteredUnsupportedTypes:t}}function o(n,t,o){const{description:l,domain:p,editable:r,fieldName:a,hint:s,input:u,label:d,requiredExpression:m,visibilityExpression:y}=n,f=t[m]||null,c=t[y]||null,x=new i({description:l,domain:p,editable:r,hint:s,label:d,name:a,requiredExpression:f,visibilityExpression:c});if(u)if("barcode-scanner"===u.type||"text-area"===u.type||"text-box"===u.type)x.editorType=u.type,x.minLength=u.minLength,x.maxLength=u.maxLength;else if("combo-box"===u.type||"radio-buttons"===u.type)x.editorType=u.type,x.noValueOptionLabel=u.noValueOptionLabel,x.showNoValueOption=u.showNoValueOption;else if("switch"===u.type)x.editorType=u.type,x.offValue=u.offValue,x.onValue=u.onValue;else if("datetime-picker"===u.type){x.editorType=u.type,x.includeTime=u.includeTime;const{max:i,min:n}=u;if(i||n){const t="range"===(null==p?void 0:p.type)?Math.min(null==i?void 0:i.getTime(),p.maxValue):null==i?void 0:i.getTime(),o="range"===(null==p?void 0:p.type)?Math.max(null==n?void 0:n.getTime(),p.minValue):null==n?void 0:n.getTime();x.domain=new e({maxValue:t,minValue:o,name:"__internal-range-domain-based-on-datetime-picker-input__"})}}else o.push({type:"unsupported-input-type",details:u});return x}function l(e,i,t,p=!0){return e.map((e=>{if("field"===e.type)return o(e,i,t);if("group"===e.type){if(!p)return t.push({type:"nested-group",details:e}),null;const o=i[e.visibilityExpression]||null;return new n({description:e.description,state:e.initialState,fieldConfig:l(e.elements,i,t,!1),label:e.label,visibilityExpression:o})}return t.push({type:"unsupported-element-type",details:e}),null})).filter((e=>!!e))}export{t as fieldConfigsFromFormTemplate};
