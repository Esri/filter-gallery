/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import r from"../../Color.js";import{handlesGroup as o}from"../../core/handleUtils.js";import{isNone as t,applySome as n,unwrapOr as i}from"../../core/maybe.js";import{memoize as s}from"../../core/memoize.js";import{watch as a}from"../../core/reactiveUtils.js";import{getMetersPerVerticalUnitForSR as l}from"../../core/unitUtils.js";import{property as u}from"../../core/accessorSupport/decorators/property.js";import"../../core/arrayUtils.js";import"../../core/has.js";import"../../core/accessorSupport/ensureType.js";import{subclass as p}from"../../core/accessorSupport/decorators/subclass.js";import c from"./ElevationProfileLine.js";import{getGroundMinDemResolution as d}from"./support/elevationQuerySourceUtils.js";let m=class extends c{constructor(e){super(e),this.type="ground",this.color=new r("#ff7f00"),this.viewVisualizationEnabled=!0,this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getQueryElevationDependencies=s(((e,r)=>({ground:e,groundLayers:r})))}get available(){const e=this._ground;return!t(e)&&e.layers.some((e=>e.visible))}get minDemResolution(){return d(this._ground)}get queryElevationDependencies(){return this._getQueryElevationDependencies(this._ground,this._groundLayers)}get _ground(){var e;return n(null==(e=this._viewModel)?void 0:e.view,(e=>{var r;return null==(r=e.map)?void 0:r.ground}))}get _groundLayers(){const e=this._ground,r=n(e,(e=>{var r;return null==(r=e.layers)?void 0:r.toArray()}));return i(r,[])}async queryElevation(e,r){const o=this.queryElevationDependencies;if(t(o))throw new Error("ElevationProfileLineGround: no dependencies");const{ground:n}=o;if(t(n))throw new Error("No ground configured in the view");const i=await n.queryElevation(e,r),s=l(e.spatialReference),a=l(n.layers.getItemAt(0).spatialReference);if(s!==a){const e=i.geometry;e.points=e.points.map((([e,o,t])=>[e,o,t===r.noDataValue?t:t*a/s]))}return i}attach(e){return o([super.attach(e),a((()=>this.queryElevationDependencies),(()=>this._onChange()))])}};e([u({type:r,nonNullable:!0})],m.prototype,"color",void 0),e([u()],m.prototype,"viewVisualizationEnabled",void 0),e([u()],m.prototype,"available",null),e([u({readOnly:!0})],m.prototype,"minDemResolution",null),e([u()],m.prototype,"queryElevationDependencies",null),e([u()],m.prototype,"_ground",null),e([u()],m.prototype,"_groundLayers",null),m=e([p("esri.widgets.ElevationProfile.ElevationProfileLineGround")],m);const y=m;export{y as default};
