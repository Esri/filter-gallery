/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{getAssetUrl as s}from"../assets.js";import a from"../core/Handles.js";import{on as t,whenOnce as i}from"../core/watchUtils.js";import{aliasOf as r}from"../core/accessorSupport/decorators/aliasOf.js";import"../core/arrayUtils.js";import"../core/has.js";import"../core/accessorSupport/ensureType.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import{subclass as l}from"../core/accessorSupport/decorators/subclass.js";import m from"./Widget.js";import d from"./BasemapGallery/BasemapGalleryViewModel.js";import{Heading as p}from"./support/Heading.js";import{accessibleHandler as n}from"./support/decorators/accessibleHandler.js";import{messageBundle as c}from"./support/decorators/messageBundle.js";import"../core/Logger.js";import{tsx as g}from"./support/jsxFactory.js";import"./support/widgetUtils.js";const h={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled",loaderAnimation:"esri-widget__loader-animation"};let u=class extends m{constructor(e,s){super(e,s),this._handles=new a,this.activeBasemap=null,this.disabled=!1,this.headingLevel=2,this.iconClass=h.widgetIcon,this.label=void 0,this.messages=null,this.source=null,this.view=null,this.viewModel=new d}initialize(){const e=this._handles;this.own([t(this,"viewModel.items","change",(s=>{const a="basemap-gallery-item-changes",{added:t,moved:i}=s;e.remove(a),e.add([...t,...i].map((e=>e.watch("state",(()=>this.scheduleRender())))),a),this.scheduleRender()})),e,i(this,"source",(()=>this.viewModel.load()))])}loadDependencies(){return import("@esri/calcite-components/dist/components/calcite-scrim.js")}render(){const e="loading"===this.get("source.state"),s=this.disabled||"disabled"===this.get("viewModel.state"),a=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),t={[h.sourceLoading]:e,[h.disabled]:s},i=e?g("div",{class:h.loader,key:"esri-basemap-gallery__loader"}):null,r=e?null:a.length>0?g("ul",{class:h.itemContainer,key:"esri-basemap-gallery__item-container",role:"menu"},a):g("div",{class:h.emptyMessage,key:"esri-basemap-gallery__empty-message"},g(p,{level:this.headingLevel},this.messages.noBasemaps));return g("div",{class:this.classes(h.base,t)},i,r)}_handleClick(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.viewModel.activeBasemap=s.basemap)}_renderBasemapGalleryItem(e){const a=e.get("basemap.thumbnailUrl")||s("esri/themes/base/images/basemap-toggle-64.svg"),t=e.get("basemap.title"),i=e.get("basemap.portalItem.snippet"),r=e.get("error.message")||i||t,{viewModel:o}=this,l=!this.disabled&&"disabled"!==o.state&&"ready"===e.state?0:-1,m=o.basemapEquals(e.basemap,this.activeBasemap),d="loading"===o.state,p={[h.selectedItem]:m,[h.itemError]:"error"===e.state};return g("li",{"aria-selected":m.toString(),bind:this,class:this.classes(h.item,p),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:l,title:r},g("img",{alt:"",class:h.itemThumbnail,src:a}),g("div",{class:h.itemTitle},t),"loading"===e.state||m&&d?g("calcite-scrim",null,g("span",{"aria-hidden":"true",role:"presentation",class:h.loaderAnimation})):null)}};e([r("viewModel.activeBasemap")],u.prototype,"activeBasemap",void 0),e([o()],u.prototype,"disabled",void 0),e([o()],u.prototype,"headingLevel",void 0),e([o()],u.prototype,"iconClass",void 0),e([o({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],u.prototype,"label",void 0),e([o(),c("esri/widgets/BasemapGallery/t9n/BasemapGallery")],u.prototype,"messages",void 0),e([r("viewModel.source")],u.prototype,"source",void 0),e([r("viewModel.view")],u.prototype,"view",void 0),e([o()],u.prototype,"viewModel",void 0),e([n()],u.prototype,"_handleClick",null),u=e([l("esri.widgets.BasemapGallery")],u);const b=u;export{b as default};
