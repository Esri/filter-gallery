/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{isSome as r}from"../core/maybe.js";import{memoize as o}from"../core/memoize.js";import{aliasOf as s}from"../core/accessorSupport/decorators/aliasOf.js";import"../core/arrayUtils.js";import"../core/has.js";import"../core/accessorSupport/ensureType.js";import{property as t}from"../core/accessorSupport/decorators/property.js";import{subclass as i}from"../core/accessorSupport/decorators/subclass.js";import{getWeatherTypes as n}from"../views/3d/environment/weather.js";import l from"./Widget.js";import{Heading as a}from"./support/Heading.js";import"./support/widgetUtils.js";import{messageBundle as d}from"./support/decorators/messageBundle.js";import"../core/Logger.js";import{tsx as c,tsxFragment as u}from"./support/jsxFactory.js";import{CoverageSlider as g}from"./Weather/CoverageSlider.js";import{CSS as p}from"./Weather/css.js";import{WeatherState as h}from"./Weather/enums.js";import v from"./Weather/WeatherViewModel.js";const m={sunny:"brightness",cloudy:"partly-cloudy",rainy:"rain",snowy:"snow",foggy:"fog"};let y=class extends l{constructor(e){super(e),this.viewModel=new v,this.headingLevel=4,this.iconClass=p.widgetIcon,this.label=void 0,this._renderWeatherTypeButton=e=>{var r,o;const s=this.viewModel,t=null==(r=this.messages)||null==(o=r[e])?void 0:o.label,i=s.state===h.Disabled,n=!i&&s.current.type===e;return c("calcite-button",{appearance:n?"solid":"outline","aria-checked":n?"true":"false",color:n?"blue":"neutral",disabled:i,"icon-start":m[e],key:`${e}-type-button`,label:t,role:"radio",scale:"l",title:t,onclick:()=>{n||s.setWeatherByType(e)}})},this._getOnSunnyChange=o((e=>r=>{e.cloudCover=r})),this._getOnCloudyChange=o((e=>r=>{e.cloudCover=r})),this._getOnRainyChange=o((e=>r=>{e.cloudCover=r})),this._getOnSnowyChange=o((e=>r=>{e.cloudCover=r})),this._getOnFoggyChange=o((e=>r=>{e.fogStrength=r}))}render(){var e;const r=this.viewModel.state===h.Disabled;return c("div",{class:this.classes(p.base,p.esriWidget,r&&p.esriWidgetDisabled),role:"region","aria-label":null==(e=this.messages)?void 0:e.widgetLabelAccessible},this._renderContent())}async loadDependencies(){await Promise.all([import("@esri/calcite-components/dist/components/calcite-button.js"),import("@esri/calcite-components/dist/components/calcite-icon.js"),import("@esri/calcite-components/dist/components/calcite-label.js")])}get view(){var e;return null==(e=this.viewModel)?void 0:e.view}set view(e){this.viewModel&&(this.viewModel.view=e)}get _errorMessage(){var e;const r=null==(e=this.messages)?void 0:e.error;switch(this.viewModel.error){case"unsupported-view":return r.unsupported;case"local-scene":return r.localScene;default:return null}}get _warningMessage(){if("not-visible"===this.viewModel.error){var e,o;return r(this.view)&&"3d"===(null==(e=this.view)?void 0:e.type)&&this.view.environment.atmosphereEnabled?null==(o=this.messages)?void 0:o.error.notVisible:null}return null}_renderContent(){if(this.viewModel.state===h.Error)return c("div",{key:"error",class:p.error},this._errorMessage);const e=this.messages,o=this._warningMessage;return c(u,null,c(a,{level:this.headingLevel},null==e?void 0:e.widgetLabel),c("div",{class:p.content},c("div",{class:p.selector,role:"radiogroup","aria-label":null==e?void 0:e.weatherType},n().map(this._renderWeatherTypeButton)),this._renderOptions(),r(o)&&this._renderWarning(o)))}_renderOptions(){const e=this.viewModel,r=e.state===h.Disabled,o=e.current,s=this.messages;switch(o.type){case"sunny":return c(g,{key:"sunny-slider",disabled:r,label:null==s?void 0:s.sunny.cloudCover,value:o.cloudCover,onChange:this._getOnSunnyChange(o)});case"cloudy":return c(g,{key:"cloudy-slider",disabled:r,label:null==s?void 0:s.cloudy.cloudCover,value:o.cloudCover,onChange:this._getOnCloudyChange(o)});case"rainy":return c(g,{key:"rainy-slider",disabled:r,label:null==s?void 0:s.rainy.cloudCover,value:o.cloudCover,onChange:this._getOnRainyChange(o)});case"snowy":return c(g,{key:"snowy-slider",disabled:r,label:null==s?void 0:s.rainy.cloudCover,value:o.cloudCover,onChange:this._getOnSnowyChange(o)});case"foggy":return c(g,{key:"foggy-slider",disabled:r,label:null==s?void 0:s.foggy.fogStrength,value:o.fogStrength,onChange:this._getOnFoggyChange(o)})}}_renderWarning(e){return c("div",{key:"warning",class:p.warning},c("calcite-icon",{icon:"exclamation-mark-triangle",scale:"s"}),e)}};e([t()],y.prototype,"viewModel",void 0),e([t()],y.prototype,"view",null),e([t()],y.prototype,"headingLevel",void 0),e([t()],y.prototype,"iconClass",void 0),e([s("messages.widgetLabel",{overridable:!0})],y.prototype,"label",void 0),e([t(),d("esri/widgets/Weather/t9n/Weather")],y.prototype,"messages",void 0),e([t()],y.prototype,"_errorMessage",null),e([t()],y.prototype,"_warningMessage",null),y=e([i("esri.widgets.Weather")],y);const w=y;export{w as default};
