/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../../chunks/tslib.es6.js";import t from"../../core/Evented.js";import r from"../../core/Logger.js";import{isSome as o,isNone as i}from"../../core/maybe.js";import{property as s}from"../../core/accessorSupport/decorators/property.js";import"../../core/arrayUtils.js";import"../../core/has.js";import"../../core/accessorSupport/ensureType.js";import{subclass as n}from"../../core/accessorSupport/decorators/subclass.js";import{toExtent as a}from"../../geometry/support/aaBoundingRect.js";import{extentContainsPoint as p}from"../../geometry/support/contains.js";import{canProject as l}from"../../geometry/support/webMercatorUtils.js";import{updateGeometryElevation as m}from"../../layers/support/ElevationSampler.js";import{getElevationAtPoint as c}from"../3d/support/ElevationProvider.js";import{ELEVATION_NODATA_VALUE as u}from"../3d/terrain/TerrainConst.js";const d=r.getLogger("esri.views.support.GroundViewElevationSampler");let f=class extends t.EventedAccessor{constructor(e){super(e),this.demResolution={min:-1,max:-1},this.noDataValue=u}initialize(){this.view.basemapTerrain.on("elevation-change",(()=>this.emit("changed",{})))}get extent(){const e=this.view.basemapTerrain;return o(e.extent)&&e.spatialReference?a(e.extent,e.spatialReference):null}elevationAt(e){const t=e.spatialReference,r=this.spatialReference;if(!l(t,r)){const e=t?t.wkid:"unknown";return d.error(`Cannot sample elevation at a location with spatial reference (${e}) different from the view (${r.wkid})`),null}if(i(this.extent)||!p(this.extent,e)){const t=o(this.extent)?`${this.extent.xmin}, ${this.extent.ymin}, ${this.extent.xmax}, ${this.extent.ymax}`:null;return d.warn("#elevationAt()",`Point used to sample elevation (${e.x}, ${e.y}) is outside of the sampler extent (${t})`),this.noDataValue}return c(this.view.elevationProvider,e)}queryElevation(e){return m(e.clone(),this)}};e([s({readOnly:!0})],f.prototype,"demResolution",void 0),e([s({readOnly:!0})],f.prototype,"extent",null),e([s({readOnly:!0})],f.prototype,"noDataValue",void 0),e([s({readOnly:!0,aliasOf:"view.basemapTerrain.spatialReference"})],f.prototype,"spatialReference",void 0),e([s({constructOnly:!0})],f.prototype,"view",void 0),f=e([n("esri.views.support.GroundViewElevationSampler")],f);const v=f;export{v as default};
