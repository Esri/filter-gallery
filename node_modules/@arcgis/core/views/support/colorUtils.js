/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import t from"../../Color.js";import{isSome as r}from"../../core/maybe.js";async function n(r){await r.whenReady();const n=r.basemapView.baseLayerViews.map((t=>t.layer));if(!n.length){const n=getComputedStyle(r.container).backgroundColor,a=n&&new t(n);return r.get("background.color")||(a&&0!==a.a?a:null)||null}const a=(await r.takeScreenshot({format:"png",layers:n.toArray()})).data.data,o=a.length;let e=0,u=0,l=0,s=0,c=0,i=0;for(let t=0;t<o;t+=4){const r=a[t],n=a[t+1],o=a[t+2],h=a[t+3],d=h/255;e+=r*r*d,u+=n*n*d,l+=o*o*d,c+=d,h&&(s+=h,i++)}e=Math.round(Math.sqrt(e/c)),u=Math.round(Math.sqrt(u/c)),l=Math.round(Math.sqrt(l/c));return new t([e,u,l,s/i/255])}async function a(t){if(!t)return null;const a=await n(t);return r(a)?o(a):null}function o(t){return e(t).isBright?"light":"dark"}function e(r){let{r:n,g:a,b:o,a:e}=r;return e<1&&(n=Math.round(e*n+255*(1-e)),a=Math.round(e*a+255*(1-e)),o=Math.round(e*o+255*(1-e))),new t({r:n,g:a,b:o})}export{n as getBackgroundColor,a as getBackgroundColorTheme};
