/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{bidiText as e}from"../../../../core/BidiText.js";import{unwrap as t}from"../../../../core/maybe.js";import{pt2px as n}from"../../../../core/screenUtils.js";import i from"../../../../geometry/Polygon.js";import{create as r}from"../../../../geometry/support/aaBoundingRect.js";import{getSpatialReferenceMinMaxX as o}from"../../../../geometry/support/normalizeUtilsCommon.js";import{getXAnchorDirection as s,getYAnchorDirection as l}from"../../engine/webgl/alignmentUtils.js";import{GLYPH_SIZE as m,MAGIC_LABEL_LINE_HEIGHT as a}from"../../engine/webgl/definitions.js";import{shapeGlyphs as f}from"../../engine/webgl/mesh/templates/shapingUtils.js";const c=512,u=50;function g(e,t){if(!t.isWrappable)return null;const[n,i]=o(t);return e[2]>i?[r([e[0],e[1],i,e[3]]),r([n,e[1],n+e[2]-i,e[3]])]:e[0]<n?[r([n,e[1],e[2],e[3]]),r([i-(n-e[0]),e[1],i,e[3]])]:null}function p(e){return"text"===e||"esriTS"===e}function h(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function y(e){switch(t(e.geometry).type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function x(t,i,r){var o,c,u;if(!r||0===r.glyphMosaicItems.length)return t;const g=e(i.text)[1],p=r.glyphMosaicItems,h=f(p,g,{scale:n(i.font.size)/m,angle:null!=(o=i.angle)?o:0,xOffset:null!=(c=i.xoffset)?c:0,yOffset:null!=(u=i.yoffset)?u:0,hAlign:s(i.horizontalAlignment||"center"),vAlign:l(i.verticalAlignment||"baseline"),maxLineWidth:Math.max(32,Math.min(i.lineWidth||512,512)),lineHeight:a*Math.max(.25,Math.min(i.lineHeight||1,4)),decoration:i.font.decoration||"none",isCIM:!1}).bounds;return t[0]=n(h.x-h.halfWidth),t[1]=n(h.y-h.halfHeight),t[2]=n(h.width),t[3]=n(h.height),t}function d(e){if(!e)return null;const{xmin:t,ymin:n,xmax:r,ymax:o,spatialReference:s}=e;return new i({rings:[[[t,n],[t,o],[r,o],[r,n],[t,n]]],spatialReference:s})}export{u as PIXEL_BUFFER,c as TILE_SIZE,x as getTextSymbolSize,y as graphicGeometryToNumber,g as intersectingInternationalDateline,h as isMarkerSymbol,p as isTextSymbol,d as polygonFromExtent};
