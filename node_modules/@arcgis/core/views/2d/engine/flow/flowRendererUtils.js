/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{pt2px as e}from"../../../../core/screenUtils.js";function t(t){const o=s(t),r=n(o),l=2*r,u=Math.round(e(t.maxPathLength)/l)+1,p=r,c=10,h=i(t),f=a(t),{flowSpeed:d,trailLength:g,density:m}=t;return{lineRenderWidth:o,segmentLength:l,verticesPerLine:u,lineCollisionWidth:p,lineSpacing:c,lineColor:h,lineOpacity:f,lineSpeed:d,fadeDuration:g,density:m,smoothing:e(t.smoothing),velocityScale:"flow-from"===t.flowRepresentation?1:-1,minWeightThreshold:.001,minSpeedThreshold:.001,maxTurnAngle:1,mergeLines:!0,interpolate:!0,profile:!1}}function n(e){return"constant"===e.kind?e.value[0]:e.values[e.values.length-1]}function o(e){const t=e.toRgba();return[t[0]/255,t[1]/255,t[2]/255,t[3]]}function s(t){if(!t.hasVisualVariables("size"))return{kind:"constant",value:[e(t.trailWidth)]};const n=t.getVisualVariablesForType("size")[0],o=[],s=[];let i;if(n.stops){for(const e of n.stops)o.push(e.value),s.push(e.size);i=n.stops.length}else o.push(n.minDataValue,n.maxDataValue),s.push(n.minSize,n.maxSize),i=2;return{kind:"ramp",stops:o,values:s,count:i}}function i(e){if(!e.hasVisualVariables("color"))return{kind:"constant",value:o(e.color)};const t=e.getVisualVariablesForType("color")[0],n=[],s=[];for(const i of t.stops)n.push(i.value),Array.prototype.push.apply(s,o(i.color));return{kind:"ramp",stops:n,values:s,count:t.stops.length}}function a(e){if(!e.hasVisualVariables("opacity"))return{kind:"constant",value:[1]};const t=e.getVisualVariablesForType("opacity")[0],n=[],o=[];for(const s of t.stops)n.push(s.value),o.push(s.opacity);return{kind:"ramp",stops:n,values:o,count:t.stops.length}}export{t as createFlowRendererSettings};
