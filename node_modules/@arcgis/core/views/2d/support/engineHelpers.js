/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{bidiText as e}from"../../../core/BidiText.js";import{pt2px as t}from"../../../core/screenUtils.js";import{getXAnchorDirection as n,getYAnchorDirection as i}from"../engine/webgl/alignmentUtils.js";import{MAGIC_LABEL_LINE_HEIGHT as o,GLYPH_SIZE as s}from"../engine/webgl/definitions.js";import{shapeGlyphs as r}from"../engine/webgl/mesh/templates/shapingUtils.js";async function l(l,a,m){var f,g,c;const d=n("center"),u=i("middle"),h=a.textureManager.rasterizeItem(l.toJSON(),window.devicePixelRatio||1,null,m),[,x]=e(l.text),p=(await h).glyphMosaicItems;return r(p,x,{angle:null!=(f=l.angle)?f:0,xOffset:t(null!=(g=l.xoffset)?g:0),yOffset:t(null!=(c=l.yoffset)?c:0),lineHeight:o*Math.max(.25,l.lineHeight),maxLineWidth:Math.max(32,Math.min(t(l.lineWidth),512)),decoration:l.font.decoration,scale:Math.min(Math.round(t(l.font.size)),127)/s,hAlign:d,vAlign:u,isCIM:!1}).boundsT}let a=l;async function m(e,t,n){return a(e,t,n)}const f={stubGetTextBounds:e=>a=e,restoreGetTextBounds:()=>a=l};export{m as getTextBounds,f as test};
