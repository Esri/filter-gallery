/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as t}from"../../../../chunks/tslib.es6.js";import e from"../../../../core/Accessor.js";import r from"../../../../core/Evented.js";import{isSome as o,isNone as s}from"../../../../core/maybe.js";import{property as i}from"../../../../core/accessorSupport/decorators/property.js";import"../../../../core/arrayUtils.js";import"../../../../core/has.js";import"../../../../core/accessorSupport/ensureType.js";import{subclass as a}from"../../../../core/accessorSupport/decorators/subclass.js";import{projectPoint as c}from"../../../../geometry/projection.js";import{getObjectId as p}from"../../../../layers/graphics/dehydratedFeatures.js";import{OptimizedFeature as n}from"../../../../layers/graphics/OptimizedFeature.js";import h from"../../../../layers/graphics/OptimizedGeometry.js";import{optimizedFeatureQueryEngineAdapter as l}from"../../../../layers/graphics/data/optimizedFeatureQueryEngineAdapter.js";let d=class extends e{constructor(t){super(t),this.events=new r,this.hasZ=null,this.hasM=null,this.objectIdField=null,this.spatialReference=null,this.featureAdapter={getAttribute:(t,e)=>"graphic"in t?t.graphic.attributes[e]:l.getAttribute(t,e),getAttributes:t=>"graphic"in t?t.graphic.attributes:l.getAttributes(t),getObjectId:t=>"graphic"in t?p(t.graphic,this.objectIdField):l.getObjectId(t),getGeometry:t=>"graphic"in t?t.getAsOptimizedGeometry(this.hasZ,this.hasM):l.getGeometry(t),getCentroid:(t,e)=>{if("graphic"in t){let r=null;o(t.centroid)?r=t.centroid:"point"===t.graphic.geometry.type&&c(t.graphic.geometry,u,this.spatialReference)&&(r=u);const i=new Array(2+(e.hasZ?1:0)+(e.hasM?1:0));return s(r)?(i[0]=0,i[1]=0,i[2]=0,i[3]=0):(i[0]=r.x,i[1]=r.y,e.hasZ&&(i[2]=r.hasZ?r.z:0),e.hasM&&(i[e.hasZ?3:2]=r.hasM?r.m:0)),new h([],i)}return l.getCentroid(t,e)},cloneWithGeometry:(t,e)=>"graphic"in t?new n(e,this.featureAdapter.getAttributes(t),null,this.featureAdapter.getObjectId(t)):l.cloneWithGeometry(t,e)}}forEach(t){this.forAllGraphics((e=>{t(e)}))}forEachInBounds(t,e){this.getSpatialIndex().forEachInBounds(t,e)}forEachBounds(t,e,r){const s=this.getSpatialIndex();for(const i of t){const t=this.featureAdapter.getObjectId(i);o(s.getBounds(t,r))&&e(r)}}};t([i({constructOnly:!0})],d.prototype,"getSpatialIndex",void 0),t([i({constructOnly:!0})],d.prototype,"forAllGraphics",void 0),t([i({constructOnly:!0})],d.prototype,"hasZ",void 0),t([i({constructOnly:!0})],d.prototype,"hasM",void 0),t([i({constructOnly:!0})],d.prototype,"objectIdField",void 0),t([i({constructOnly:!0})],d.prototype,"spatialReference",void 0),t([i({constructOnly:!0})],d.prototype,"featureSpatialReference",void 0),d=t([a("esri.views.3d.layers.graphics.Graphics3DFeatureStore")],d);const u={type:"point",x:0,y:0,hasZ:!1,hasM:!1,spatialReference:null},m=d;export{d as Graphics3DFeatureStore,m as default};
