/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{getAssetUrl as t}from"../../assets.js";import e from"../../Color.js";import r from"../../request.js";import o from"../../core/ItemCache.js";import{pt2px as n}from"../../core/screenUtils.js";import{getCIMSymbolColor as i}from"./cimSymbolUtils.js";const s="picture-fill",l="simple-fill",c="simple-line",a="simple-marker",m="text",u="cim",p={left:"start",center:"middle",right:"end",justify:"start"},f={top:"text-before-edge",middle:"central",baseline:"alphabetic",bottom:"text-after-edge"},d=new o(1e3);function h(t){let e=t.horizontalAlignment;return e=e&&p[e.toLowerCase()]||"middle",e}function g(t){const e=t.verticalAlignment;return e&&f[e.toLowerCase()]||"alphabetic"}function y(t){return"bottom"===t.verticalAlignment?"super":null}function b(e){const r=e.style;let o=null;if(e)switch(e.type){case a:"cross"!==r&&"x"!==r&&(o=e.color);break;case l:"solid"===r?o=e.color:"none"!==r&&(o={type:"pattern",x:0,y:0,src:t(`esri/symbols/patterns/${r}.png`),width:5,height:5});break;case s:o={type:"pattern",src:e.url,width:n(e.width)*e.xscale,height:n(e.height)*e.yscale,x:n(e.xoffset),y:n(e.yoffset)};break;case m:o=e.color;break;case u:o=i(e)}return o}function w(t,e){const o=t+"-"+e;return void 0!==d.get(o)?Promise.resolve(d.get(o)):r(t,{responseType:"image"}).then((t=>{const r=t.data,n=r.naturalWidth,i=r.naturalHeight,s=document.createElement("canvas");s.width=n,s.height=i;const l=s.getContext("2d");l.fillStyle=e,l.fillRect(0,0,n,i),l.globalCompositeOperation="destination-in",l.drawImage(r,0,0);const c=s.toDataURL();return d.put(o,c),c}))}function j(t){if(!t)return null;let e;switch(t.type){case l:case s:case a:e=j(t.outline);break;case c:{const r=n(t.width);"none"!==t.style&&0!==r&&(e={color:t.color,style:x(t.style),width:r,cap:t.cap,join:"miter"===t.join?n(t.miterLimit):t.join});break}default:e=null}return e}const x=function(){const t={};return function(e){if(t[e])return t[e];const r=e.replace(/-/g,"");return t[e]=r,r}}(),k=new e([128,128,128]);export{k as defaultThematicColor,x as dekebabifyLineStyle,b as getFill,w as getPatternUrlWithColor,h as getSVGAlign,g as getSVGBaseline,y as getSVGBaselineShift,j as getStroke};
