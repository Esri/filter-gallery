/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as e}from"../chunks/tslib.es6.js";import{property as t}from"../core/accessorSupport/decorators/property.js";import"../core/arrayUtils.js";import"../core/has.js";import"../core/accessorSupport/ensureType.js";import{subclass as r}from"../core/accessorSupport/decorators/subclass.js";import o from"../geometry/Extent.js";import s from"../geometry/SpatialReference.js";import{execute as n}from"../rest/geoprocessor/execute.js";import{submitJob as i}from"../rest/geoprocessor/submitJob.js";import u from"../rest/geoprocessor/GPOptions.js";import p from"../rest/support/JobInfo.js";import c from"./Task.js";let a=class extends c{constructor(e){super(e),this._jobs=new Map,this.outSpatialReference=null,this.processExtent=null,this.processSpatialReference=null,this.returnFeatureCollection=!1,this.returnM=!1,this.returnZ=!1}destroy(){this._jobs.forEach((e=>e.destroy())),this._jobs.clear()}cancelJob(e,t){const r=this._getOrAddJob(e),o={...this.requestOptions,...t};return r.cancelJob(o)}checkJobStatus(e,t){const r=this._getOrAddJob(e),o={...this.requestOptions,...t};return r.checkJobStatus(o)}execute(e,t){const r=new u({outSpatialReference:this.outSpatialReference,processExtent:this.processExtent,processSpatialReference:this.processSpatialReference,returnFeatureCollection:this.returnFeatureCollection,returnM:this.returnM,returnZ:this.returnZ}),o={...this.requestOptions,...t};return n(this.url,e,r,o)}getResultData(e,t,r){const o=this._getOrAddJob(e),{returnFeatureCollection:s,returnM:n,returnZ:i,outSpatialReference:p}=this,c=new u({returnFeatureCollection:s,returnM:n,returnZ:i,outSpatialReference:p,url:this.url}),a={...this.requestOptions,...r};return o.fetchResultData(t,c,a)}getResultImage(e,t,r,o){const s=this._getOrAddJob(e),n={...this.requestOptions,...o};return s.fetchResultImage(t,r,n)}async getResultMapImageLayer(e){return this._getOrAddJob(e).fetchResultMapImageLayer()}submitJob(e,t){const r=new u({outSpatialReference:this.outSpatialReference,processExtent:this.processExtent,processSpatialReference:this.processSpatialReference,returnFeatureCollection:this.returnFeatureCollection,returnM:this.returnM,returnZ:this.returnZ}),o={...this.requestOptions,...t};return i(this.url,e,r,o).then((e=>(e.sourceUrl=this.url,this._jobs.set(e.jobId,e),e)))}waitForJobCompletion(e,t={}){return this._getOrAddJob(e).waitForJobCompletion(t)}_getOrAddJob(e){let t=this._jobs.get(e);return t||(t=new p({sourceUrl:this.url,jobId:e}),this._jobs.set(t.jobId,t)),t}};e([t({type:s})],a.prototype,"outSpatialReference",void 0),e([t({type:o})],a.prototype,"processExtent",void 0),e([t({type:s})],a.prototype,"processSpatialReference",void 0),e([t({nonNullable:!0})],a.prototype,"returnFeatureCollection",void 0),e([t({nonNullable:!0})],a.prototype,"returnM",void 0),e([t({nonNullable:!0})],a.prototype,"returnZ",void 0),a=e([r("esri.tasks.Geoprocessor")],a);const l=a;export{l as default};
