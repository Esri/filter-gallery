/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.23/esri/copyright.txt for details.
*/
import{_ as t}from"../chunks/tslib.es6.js";import{makeHandle as e}from"../core/handleUtils.js";import{property as o}from"../core/accessorSupport/decorators/property.js";import"../core/arrayUtils.js";import"../core/has.js";import"../core/accessorSupport/ensureType.js";import{subclass as s}from"../core/accessorSupport/decorators/subclass.js";import i from"../widgets/Widget.js";import{isWidget as r}from"../widgets/support/widget.js";import{createFocusTrap as n}from"focus-trap";import{messageBundle as a}from"../widgets/support/decorators/messageBundle.js";import{tsx as c}from"../widgets/support/jsxFactory.js";const l={base:"esri-identity-modal",open:"esri-identity-modal--open",closed:"esri-identity-modal--closed",title:"esri-identity-modal__title",dialog:"esri-identity-modal__dialog",content:"esri-identity-modal__content",closeButton:"esri-identity-modal__close-button",iconClose:"esri-icon-close"};let d=class extends i{constructor(t,e){super(t,e),this.container=document.createElement("div"),this.content=null,this.open=!1,this._close=()=>{this.open=!1},document.body.appendChild(this.container),this.own(this.watch("open",(()=>this._toggleFocusTrap())))}destroy(){this._destroyFocusTrap()}render(){const t=this.id,{open:e,content:o,title:s,messages:i}=this,r=e&&!!o,n={[l.open]:r,[l.closed]:!r},a=c("button",{class:l.closeButton,"aria-label":i.close,title:i.close,bind:this,onclick:this._close},c("span",{"aria-hidden":"true",class:l.iconClose})),d=`${t}_title`,p=`${t}_content`,u=s?c("h1",{id:d,class:l.title},s):null,m=r?c("div",{bind:this,class:l.dialog,role:"dialog","aria-labelledby":d,"aria-describedby":p,afterCreate:this._createFocusTrap},a,u,this._renderContent(p)):null;return c("div",{tabIndex:-1,class:this.classes(l.base,n)},m)}_destroyFocusTrap(){var t;null==(t=this._focusTrap)||t.deactivate({onDeactivate:null}),this._focusTrap=null}_toggleFocusTrap(){const{_focusTrap:t,open:e}=this;t&&(e?t.activate():t.deactivate())}_createFocusTrap(t){this._destroyFocusTrap();const o=requestAnimationFrame((()=>{this._focusTrap=n(t,{initialFocus:"input",onDeactivate:this._close}),this._toggleFocusTrap()}));this.own(e((()=>cancelAnimationFrame(o))))}_renderContent(t){const e=this.content;return"string"==typeof e?c("div",{class:l.content,id:t,innerHTML:e}):r(e)?c("div",{class:l.content,id:t},e.render()):e instanceof HTMLElement?c("div",{class:l.content,id:t,bind:e,afterCreate:this._attachToNode}):null}_attachToNode(t){const e=this;t.appendChild(e)}};t([o({readOnly:!0})],d.prototype,"container",void 0),t([o()],d.prototype,"content",void 0),t([o()],d.prototype,"open",void 0),t([o(),a("esri/t9n/common")],d.prototype,"messages",void 0),t([o({aliasOf:"messages.auth.signIn"})],d.prototype,"title",void 0),d=t([s("esri.identity.IdentityModal")],d);const p=d;export{p as default};
